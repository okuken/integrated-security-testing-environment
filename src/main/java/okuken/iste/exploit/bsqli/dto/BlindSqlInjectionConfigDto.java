package okuken.iste.exploit.bsqli.dto;

import burp.IHttpService;
import okuken.iste.consts.Captions;
import okuken.iste.exploit.bsqli.command.BlindSqlInjectionJudgeCommand;
import okuken.iste.util.ByteUtil;

public class BlindSqlInjectionConfigDto {

	public static final int DEFAULT_START_INDEX = 1;
	public static final int DEFAULT_MAX_INDEX = 10;
	public static final int DEFAULT_INTERVAL_TIMEMS = 100;

	private final byte[] requestTemplate;
	private final String requestTemplateStr;

	private final IHttpService httpService;
	private final BlindSqlInjectionJudgeCommand judgeCommand;

	private boolean useChain;
	private boolean needUrlEncode;

	private Integer startIndex;
	private Integer maxIndex;
	private Integer intervalTimeMs;

	public BlindSqlInjectionConfigDto(byte[] requestTemplate, IHttpService httpService, BlindSqlInjectionJudgeCommand judgeCommand) {
		this.requestTemplate = requestTemplate;
		this.requestTemplateStr = new String(requestTemplate, ByteUtil.DEFAULT_SINGLE_BYTE_CHARSET);

		this.httpService = httpService;
		this.judgeCommand = judgeCommand;
	}

	public byte[] getRequestTemplate() {
		return requestTemplate;
	}
	public String getRequestTemplateStr() {
		return requestTemplateStr;
	}
	public IHttpService getHttpService() {
		return httpService;
	}
	public BlindSqlInjectionJudgeCommand getJudgeCommand() {
		return judgeCommand;
	}

	public boolean isUseChain() {
		return useChain;
	}
	public void setUseChain(boolean useChain) {
		this.useChain = useChain;
	}
	public boolean isNeedUrlEncode() {
		return needUrlEncode;
	}
	public void setNeedUrlEncode(boolean needUrlEncode) {
		this.needUrlEncode = needUrlEncode;
	}

	public int getStartIndex() {
		if(startIndex == null) {
			return DEFAULT_START_INDEX;
		}
		return startIndex;
	}
	public void setStartIndex(int startIndex) {
		this.startIndex = startIndex;
	}
	public int getMaxIndex() {
		if(maxIndex == null) {
			return DEFAULT_MAX_INDEX;
		}
		return maxIndex;
	}
	public void setMaxIndex(int maxIndex) {
		this.maxIndex = maxIndex;
	}
	public int getIntervalTimeMs() {
		if(intervalTimeMs == null) {
			return DEFAULT_INTERVAL_TIMEMS;
		}
		return intervalTimeMs;
	}
	public void setIntervalTimeMs(int intervalTimeMs) {
		this.intervalTimeMs = intervalTimeMs;
	}

	@Override
	public String toString() {
		return new StringBuilder()
				.append("{")
				.append(Captions.TOOLS_EXPLOIT_START_INDEX)
				.append(": ")
				.append(startIndex)
				.append(", ")
				.append(Captions.TOOLS_EXPLOIT_MAX_INDEX)
				.append(": ")
				.append(maxIndex)
				.append(", ")
				.append(Captions.TOOLS_EXPLOIT_INTERVAL_TIME)
				.append(": ")
				.append(intervalTimeMs)
				.append(", ")
				.append(Captions.TOOLS_EXPLOIT_BSQLI_JUDGEBY)
				.append(": ")
				.append(judgeCommand)
				.append("}")
				.toString();
	}

}