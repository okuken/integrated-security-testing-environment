package okuken.iste.exploit.bsqli.command;

import okuken.iste.exploit.bsqli.dto.BlindSqlInjectionJudgeDto;
import okuken.iste.exploit.bsqli.enums.BlindSqlInjectionJudgeOperatorType;

public class BlindSqlInjectionJudgeByLengthCommand implements BlindSqlInjectionJudgeCommand {

	private final BlindSqlInjectionJudgeOperatorType operator;
	private final int length;

	BlindSqlInjectionJudgeByLengthCommand(BlindSqlInjectionJudgeOperatorType operator, int length) {
		this.operator = operator;
		this.length = length;
	}

	@Override
	public boolean judge(BlindSqlInjectionJudgeDto judgeDto) {
		switch (operator) {
		case LESS_THAN:
			return judgeDto.getResponse().length < length;
		case EQUALS:
			return judgeDto.getResponse().length == length;
		case GREATER_THAN:
			return judgeDto.getResponse().length > length;
		default:
		}
		return false;
	}

	@Override
	public String toString() {
		return new StringBuilder()
				.append("length ")
				.append(operator)
				.append(" ")
				.append(Integer.toString(length))
				.toString();
	}
}
