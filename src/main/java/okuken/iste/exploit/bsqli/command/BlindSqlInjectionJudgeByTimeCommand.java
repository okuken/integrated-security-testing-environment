package okuken.iste.exploit.bsqli.command;

import okuken.iste.exploit.bsqli.dto.BlindSqlInjectionJudgeDto;
import okuken.iste.exploit.bsqli.enums.BlindSqlInjectionJudgeOperatorType;

public class BlindSqlInjectionJudgeByTimeCommand implements BlindSqlInjectionJudgeCommand {

	private final BlindSqlInjectionJudgeOperatorType operator;
	private final int timeMs;

	BlindSqlInjectionJudgeByTimeCommand(BlindSqlInjectionJudgeOperatorType operator, int timeMs) {
		this.operator = operator;
		this.timeMs = timeMs;
	}

	@Override
	public boolean judge(BlindSqlInjectionJudgeDto judgeDto) {
		switch (operator) {
		case LESS_THAN:
			return judgeDto.getTimeMs() < timeMs;
		case EQUALS:
			return judgeDto.getTimeMs() == timeMs;
		case GREATER_THAN:
			return judgeDto.getTimeMs() > timeMs;
		default:
		}
		return false;
	}

	@Override
	public String toString() {
		return new StringBuilder()
				.append("time ")
				.append(operator)
				.append(" ")
				.append(Integer.toString(timeMs))
				.append(" (ms)")
				.toString();
	}
}
